#!/Users/pg/12/python/bin/python3

import sys

sys.dont_write_bytecode = True

import os
import signal
import traceback


def on_exit(*args):
    for f in sys._current_frames():
        print(traceback.format_stack(f))
        
    os._exit(9)

__file__ = os.path.abspath(__file__)
real_handler = on_exit


def sig_handler(*args):
    real_handler(*args)

    
signal.signal(signal.SIGINT, sig_handler)
signal.signal(signal.SIGPIPE, signal.SIG_IGN)


def real_main():
    file_data = None
    data = None
    #REPLACEME

    if not data:
        with open(os.path.dirname(__file__) + '/upm/stagea.py') as f:
            data = f.read()

    args = {'where': __file__, 'data': file_data}
    ctx = {'args': args}
    exec(compile(data +'\nmain(args, **args)\n', '__main__', 'exec'), ctx)
    ctx.clear()


if __name__ == '__main__':
    real_main()
