#!/Users/pg/8/bin/python

import sys

sys.dont_write_bytecode = True

import os
import signal
import Queue
import traceback


__file__ = os.path.abspath(__file__)


def real_main():
   signal.signal(signal.SIGPIPE, signal.SIG_IGN)
   file_data = None
   data = None
   #REPLACEME

   if not data:
      with open(os.path.dirname(__file__) + '/upm/stagea.py') as f:
         data = f.read()

   qq = Queue.Queue()      

   args = {'qq': qq, 'where': __file__, 'data': file_data}
   ctx = {'args': args}
   exec compile(data +'\nmain(args, **args)\n', '__main__', 'exec') in ctx
   ctx.clear()

   while True:
      try:
         qq.get()()
      except SystemExit:
         raise
      except Exception as e:
         traceback.print_exc(e)
         os._exit(4)


if __name__ == '__main__':
    real_main()
